{
  "version": 3,
  "sources": ["../../three/examples/jsm/interactive/SelectionBox.js"],
  "sourcesContent": ["import {\r\n\tFrustum,\r\n\tVector3,\r\n\tMatrix4,\r\n\tQuaternion,\r\n} from 'three';\r\n\r\n/**\r\n * This is a class to check whether objects are in a selection area in 3D space\r\n */\r\n\r\nconst _frustum = new Frustum();\r\nconst _center = new Vector3();\r\n\r\nconst _tmpPoint = new Vector3();\r\n\r\nconst _vecNear = new Vector3();\r\nconst _vecTopLeft = new Vector3();\r\nconst _vecTopRight = new Vector3();\r\nconst _vecDownRight = new Vector3();\r\nconst _vecDownLeft = new Vector3();\r\n\r\nconst _vecFarTopLeft = new Vector3();\r\nconst _vecFarTopRight = new Vector3();\r\nconst _vecFarDownRight = new Vector3();\r\nconst _vecFarDownLeft = new Vector3();\r\n\r\nconst _vectemp1 = new Vector3();\r\nconst _vectemp2 = new Vector3();\r\nconst _vectemp3 = new Vector3();\r\n\r\nconst _matrix = new Matrix4();\r\nconst _quaternion = new Quaternion();\r\nconst _scale = new Vector3();\r\n\r\nclass SelectionBox {\r\n\r\n\tconstructor( camera, scene, deep = Number.MAX_VALUE ) {\r\n\r\n\t\tthis.camera = camera;\r\n\t\tthis.scene = scene;\r\n\t\tthis.startPoint = new Vector3();\r\n\t\tthis.endPoint = new Vector3();\r\n\t\tthis.collection = [];\r\n\t\tthis.instances = {};\r\n\t\tthis.deep = deep;\r\n\r\n\t}\r\n\r\n\tselect( startPoint, endPoint ) {\r\n\r\n\t\tthis.startPoint = startPoint || this.startPoint;\r\n\t\tthis.endPoint = endPoint || this.endPoint;\r\n\t\tthis.collection = [];\r\n\r\n\t\tthis.updateFrustum( this.startPoint, this.endPoint );\r\n\t\tthis.searchChildInFrustum( _frustum, this.scene );\r\n\r\n\t\treturn this.collection;\r\n\r\n\t}\r\n\r\n\tupdateFrustum( startPoint, endPoint ) {\r\n\r\n\t\tstartPoint = startPoint || this.startPoint;\r\n\t\tendPoint = endPoint || this.endPoint;\r\n\r\n\t\t// Avoid invalid frustum\r\n\r\n\t\tif ( startPoint.x === endPoint.x ) {\r\n\r\n\t\t\tendPoint.x += Number.EPSILON;\r\n\r\n\t\t}\r\n\r\n\t\tif ( startPoint.y === endPoint.y ) {\r\n\r\n\t\t\tendPoint.y += Number.EPSILON;\r\n\r\n\t\t}\r\n\r\n\t\tthis.camera.updateProjectionMatrix();\r\n\t\tthis.camera.updateMatrixWorld();\r\n\r\n\t\tif ( this.camera.isPerspectiveCamera ) {\r\n\r\n\t\t\t_tmpPoint.copy( startPoint );\r\n\t\t\t_tmpPoint.x = Math.min( startPoint.x, endPoint.x );\r\n\t\t\t_tmpPoint.y = Math.max( startPoint.y, endPoint.y );\r\n\t\t\tendPoint.x = Math.max( startPoint.x, endPoint.x );\r\n\t\t\tendPoint.y = Math.min( startPoint.y, endPoint.y );\r\n\r\n\t\t\t_vecNear.setFromMatrixPosition( this.camera.matrixWorld );\r\n\t\t\t_vecTopLeft.copy( _tmpPoint );\r\n\t\t\t_vecTopRight.set( endPoint.x, _tmpPoint.y, 0 );\r\n\t\t\t_vecDownRight.copy( endPoint );\r\n\t\t\t_vecDownLeft.set( _tmpPoint.x, endPoint.y, 0 );\r\n\r\n\t\t\t_vecTopLeft.unproject( this.camera );\r\n\t\t\t_vecTopRight.unproject( this.camera );\r\n\t\t\t_vecDownRight.unproject( this.camera );\r\n\t\t\t_vecDownLeft.unproject( this.camera );\r\n\r\n\t\t\t_vectemp1.copy( _vecTopLeft ).sub( _vecNear );\r\n\t\t\t_vectemp2.copy( _vecTopRight ).sub( _vecNear );\r\n\t\t\t_vectemp3.copy( _vecDownRight ).sub( _vecNear );\r\n\t\t\t_vectemp1.normalize();\r\n\t\t\t_vectemp2.normalize();\r\n\t\t\t_vectemp3.normalize();\r\n\r\n\t\t\t_vectemp1.multiplyScalar( this.deep );\r\n\t\t\t_vectemp2.multiplyScalar( this.deep );\r\n\t\t\t_vectemp3.multiplyScalar( this.deep );\r\n\t\t\t_vectemp1.add( _vecNear );\r\n\t\t\t_vectemp2.add( _vecNear );\r\n\t\t\t_vectemp3.add( _vecNear );\r\n\r\n\t\t\tconst planes = _frustum.planes;\r\n\r\n\t\t\tplanes[ 0 ].setFromCoplanarPoints( _vecNear, _vecTopLeft, _vecTopRight );\r\n\t\t\tplanes[ 1 ].setFromCoplanarPoints( _vecNear, _vecTopRight, _vecDownRight );\r\n\t\t\tplanes[ 2 ].setFromCoplanarPoints( _vecDownRight, _vecDownLeft, _vecNear );\r\n\t\t\tplanes[ 3 ].setFromCoplanarPoints( _vecDownLeft, _vecTopLeft, _vecNear );\r\n\t\t\tplanes[ 4 ].setFromCoplanarPoints( _vecTopRight, _vecDownRight, _vecDownLeft );\r\n\t\t\tplanes[ 5 ].setFromCoplanarPoints( _vectemp3, _vectemp2, _vectemp1 );\r\n\t\t\tplanes[ 5 ].normal.multiplyScalar( - 1 );\r\n\r\n\t\t} else if ( this.camera.isOrthographicCamera ) {\r\n\r\n\t\t\tconst left = Math.min( startPoint.x, endPoint.x );\r\n\t\t\tconst top = Math.max( startPoint.y, endPoint.y );\r\n\t\t\tconst right = Math.max( startPoint.x, endPoint.x );\r\n\t\t\tconst down = Math.min( startPoint.y, endPoint.y );\r\n\r\n\t\t\t_vecTopLeft.set( left, top, - 1 );\r\n\t\t\t_vecTopRight.set( right, top, - 1 );\r\n\t\t\t_vecDownRight.set( right, down, - 1 );\r\n\t\t\t_vecDownLeft.set( left, down, - 1 );\r\n\r\n\t\t\t_vecFarTopLeft.set( left, top, 1 );\r\n\t\t\t_vecFarTopRight.set( right, top, 1 );\r\n\t\t\t_vecFarDownRight.set( right, down, 1 );\r\n\t\t\t_vecFarDownLeft.set( left, down, 1 );\r\n\r\n\t\t\t_vecTopLeft.unproject( this.camera );\r\n\t\t\t_vecTopRight.unproject( this.camera );\r\n\t\t\t_vecDownRight.unproject( this.camera );\r\n\t\t\t_vecDownLeft.unproject( this.camera );\r\n\r\n\t\t\t_vecFarTopLeft.unproject( this.camera );\r\n\t\t\t_vecFarTopRight.unproject( this.camera );\r\n\t\t\t_vecFarDownRight.unproject( this.camera );\r\n\t\t\t_vecFarDownLeft.unproject( this.camera );\r\n\r\n\t\t\tconst planes = _frustum.planes;\r\n\r\n\t\t\tplanes[ 0 ].setFromCoplanarPoints( _vecTopLeft, _vecFarTopLeft, _vecFarTopRight );\r\n\t\t\tplanes[ 1 ].setFromCoplanarPoints( _vecTopRight, _vecFarTopRight, _vecFarDownRight );\r\n\t\t\tplanes[ 2 ].setFromCoplanarPoints( _vecFarDownRight, _vecFarDownLeft, _vecDownLeft );\r\n\t\t\tplanes[ 3 ].setFromCoplanarPoints( _vecFarDownLeft, _vecFarTopLeft, _vecTopLeft );\r\n\t\t\tplanes[ 4 ].setFromCoplanarPoints( _vecTopRight, _vecDownRight, _vecDownLeft );\r\n\t\t\tplanes[ 5 ].setFromCoplanarPoints( _vecFarDownRight, _vecFarTopRight, _vecFarTopLeft );\r\n\t\t\tplanes[ 5 ].normal.multiplyScalar( - 1 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.error( 'THREE.SelectionBox: Unsupported camera type.' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tsearchChildInFrustum( frustum, object ) {\r\n\r\n\t\tif ( object.isMesh || object.isLine || object.isPoints ) {\r\n\r\n\t\t\tif ( object.isInstancedMesh ) {\r\n\r\n\t\t\t\tthis.instances[ object.uuid ] = [];\r\n\r\n\t\t\t\tfor ( let instanceId = 0; instanceId < object.count; instanceId ++ ) {\r\n\r\n\t\t\t\t\tobject.getMatrixAt( instanceId, _matrix );\r\n\t\t\t\t\t_matrix.decompose( _center, _quaternion, _scale );\r\n\t\t\t\t\t_center.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\t\t\tif ( frustum.containsPoint( _center ) ) {\r\n\r\n\t\t\t\t\t\tthis.instances[ object.uuid ].push( instanceId );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( object.geometry.boundingSphere === null ) object.geometry.computeBoundingSphere();\r\n\r\n\t\t\t\t_center.copy( object.geometry.boundingSphere.center );\r\n\r\n\t\t\t\t_center.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\t\tif ( frustum.containsPoint( _center ) ) {\r\n\r\n\t\t\t\t\tthis.collection.push( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.children.length > 0 ) {\r\n\r\n\t\t\tfor ( let x = 0; x < object.children.length; x ++ ) {\r\n\r\n\t\t\t\tthis.searchChildInFrustum( frustum, object.children[ x ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SelectionBox };\r\n"],
  "mappings": "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",
  "names": []
}
